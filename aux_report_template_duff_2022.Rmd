---
title: "Network Health Survey: Supplemental Report  \n2021-2022 School Year"
author: "`r params$network_name`"

date: "Report produced on `r format(Sys.time(), '%B %d, %Y')`"
output: 
  officedown::rdocx_document:
    reference_docx: aux_report_style_template_2.23.22.docx
    tables:
      style: Table
      layout: autofit
      width: 1.0
      caption:
        style: Table Caption
        pre: 'Table '
        sep: ': '
    plots:
      style: Normal
      align: left
      caption:
        style: Image Caption
        pre: 'Figure '
        sep: ': '
params:
  network_name: Baltimore City Public Schools
  time: FALSE
  expectations: TRUE
  
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE, dpi=300, tab.topcaption = TRUE, fig.topcaption = TRUE) 
```

```{r data, include = FALSE}
library(readr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(showtext)
library(flextable)
library(modelsummary)
library(forcats)
library(officedown)
font_add_google("Merriweather", "merri")

network_data_2021<- read_csv("https://raw.githubusercontent.com/mpduff/aux_report_2022/main/aux_playset.csv")

network_roster_2021<- read_csv("https://raw.githubusercontent.com/mpduff/aux_report_2022/main/roster_Baltimore%20Secondary%20Literacy%20Improvement%20Community%20-%20BSLIC.csv")
```

```{r label_role_group_factors, include=FALSE}
network_data_2021$net_role<-factor(network_data_2021$net_role,
levels=c(1,2,3,4),
labels=c("Hub leaders", "Other school and district leaders", "Team leads", "Team members"))
```

```{r label_race_ethnicity_factors, include=FALSE}
network_data_2021<-network_data_2021%>%
  mutate(race_ethnicity=case_when(ethnicity_v3_1==1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Black/African American",
   ethnicity_v3_1!=1 & ethnicity_v3_2==1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Hispanic/Latino/Latina/Latinx",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3==1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Asian/Hawaiian/Pacific Islander",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4==1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Native American/First Nation",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5==1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "White",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6==1 & ethnicity_v3_7!=1 ~ "Prefer not to say",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7==1 ~ "Additional racial/ethnic identity",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "No response"))
network_data_2021<-network_data_2021%>%
  mutate("race_ethnicity"=replace_na(race_ethnicity, "Multiple racial/ethnic identities"))
network_data_2021$race_ethnicity<-factor(network_data_2021$race_ethnicity,
                                         levels=c("No response", "Prefer not to say", "Additional racial/ethnic identity", "Multiple racial/ethnic identities", "White", "Native American/First Nation", "Asian/Hawaiian/Pacific Islander", "Hispanic/Latino/Latina/Latinx", "Black/African American"))
network_data_2021$race_ethnicity
```

```{r label_gender_factors, include=FALSE}
network_data_2021$gender_v3
network_data_2021$gender_v3<-factor(network_data_2021$gender_v3,
levels=c(1,2,3,4,5),
labels=c("Man", "Woman", "Gender queer/Gender non-conforming", "Identity not mentioned", "Prefer not to say"))
network_data_2021<-network_data_2021%>%
  mutate("gender_v3"=fct_explicit_na(gender_v3, "No response"))
network_data_2021$gender_v3<-factor(network_data_2021$gender_v3,
                                         levels=c("No response", "Prefer not to say", "Identity not mentioned", "Gender queer/Gender non-conforming", "Woman", "Man"))
network_data_2021$gender_v3
```
\
\
\

:::{custom-style="CenterText"}
Part of the Networks for School Improvement Initiative\
Funded by The Bill and Melinda Gates Foundation
\

*Prepared by*:

![](pni_graphic.png){#id .class width=500px height=80px}
\
Learning Research and Development Center\
University of Pittsburgh\
\
\
*In collaboration with*

![](carnegie_graphic.png){#id .class width=350px height=120px}
:::

\newpage
Thank you for your participation in this year’s network health survey. The data in this report overview your network members’ responses to various questions that were included in this year’s survey but are not available through the primary report dashboard. We encourage you to review these data alongside your primary report dashboard to get a more complete understanding of your network’s current health and areas for further development.

# Who took the survey?

```{r response_rate, include=FALSE}
specific_network_data_2021<-network_data_2021%>%
  filter(network_name==params$network_name)
r21<-length(specific_network_data_2021$survey_response_id)
r21
members21<-length(network_roster_2021$first_name)
members21
rr21<-round((r21/members21)*100)
rr21
rr20<-65
```

Overall, your network’s response rate was **`r rr21`%**. This is `r if(rr21>rr20){"an improvement over"}` `r if(rr21==rr20){"consistent with"}` `r if(rr21<rr20){"below"}` last year’s response rate, which was `r rr20`%. `r if(rr21<50){"Given your network response rate was under 50%, we urge you to interpret these results with caution as they represent only a portion of your network’s membership. Please reach out to the Network Health team for tips on how to increase response rates moving forward."}`

Table 1 describes the **distribution of respondents by role group**:

```{r role_group_response_rates, echo=FALSE, tab.cap="Responses by Role Group"}
specific_network_data_2021<-network_data_2021%>%
  filter(network_name==params$network_name)
rolegroup_table<-datasummary(net_role +1 ~ N, data=specific_network_data_2021, output="flextable")
rolegroup_table%>%
  set_header_labels(net_role="Network role", N="Number of respondents")%>%
  width(width=3.25)
```
Note that both the percentages for your overall network response rate and the response rates per role group in Table 1 were calculated using your network roster data from the RAND foundation. 

Table 2 describes the **distribution of respondents by school**:\
[INSERT TABLE WITH RESPONDENTS BY SCHOOL HERE--POSSIBLE TO INCLUDE RESPONSE RATE % HERE?]

Figures \@ref(fig:rrRace) and \@ref(fig:rrGender) show **how your respondents varied by race/ethnicity and gender**, respectively. Given your knowledge of your network’s overall membership, consider whether any particular groups seem under-represented in your respondents this year. How might you increase responses from this group in future surveys to ensure all perspectives are fully reflected in your network’s data?

```{r response_rate_by_race_ethnicity, echo=FALSE, fig.id="rrRace", fig.showtext=TRUE, fig.height=3.5, fig.width=6, fig.cap="Survey Respondents by Racial Ethnic Background"}
specific_network_data_2021<-network_data_2021%>%
  filter(network_name==params$network_name)
race_ethnicity<-ggplot(specific_network_data_2021, aes(y=race_ethnicity)) +
  geom_bar(aes(x=(..count../sum(..count..))),binwidth=0.5, fill="deepskyblue1") +
  scale_x_continuous(labels=scales::percent_format(accuracy = 1L))+
  labs (
    title="What is your race/ethnicity?",
    y="Race/Ethnicity",
    x="Percent of respondents"
    )+
  theme_classic()+
  theme(plot.title.position="plot")
race_ethnicity + theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
```  

```{r response_rate_by_gender, echo=FALSE, fig.id="rrGender", fig.showtext=TRUE, fig.height=3.5, fig.width=6, fig.cap="Survey Respondents by Gender"}
gender<-ggplot(specific_network_data_2021, aes(y=gender_v3)) +
  geom_bar(aes(x=(..count../sum(..count..))),binwidth=0.5, fill="deepskyblue1") +
  scale_x_continuous(labels=scales::percent)+
  labs (
    title="What is your gender?",
    y="Gender",
    x="Percent of respondents"
    )+
  theme_classic()+
  theme(plot.title.position="plot")
gender + theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
``` 



