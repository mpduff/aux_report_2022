---
title: "Network Health Survey: Supplemental Report  \n2021-2022 School Year"
author: "`r params$network_name`"

date: "Report produced on `r format(Sys.time(), '%B %d, %Y')`"
output: 
  officedown::rdocx_document:
    reference_docx: aux_report_style_template_2.23.22.docx
    page_size:
      width: 8.5
      height: 11
      orient: "portrait"
    page_margins:
      right: 1
      bottom: 1
      top: 1
    tables:
      style: Table
      caption:
        style: Table Caption
        pre: 'Table '
        sep: ': '
    plots:
      style: Normal
      align: left
      caption:
        style: Image Caption
        pre: 'Figure '
        sep: ': '
params:
  network_name: New Visions INSI
  engagement: TRUE
  time: TRUE
  expectations: TRUE
  equity: TRUE
  trust: TRUE
  state: FALSE
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE, dpi=600, tab.topcaption = TRUE, fig.topcaption = TRUE, fig.width=6.5, fig.height=3, fig.showtext=TRUE) 
```

```{r data, include = FALSE}
library(readr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(RColorBrewer)
library(ggthemes)
library(scales)
library(showtext)
library(flextable)
library(modelsummary)
library(forcats)
library(magrittr)
library(officedown)
font_add_google("Merriweather", "merri")

network_data_2021<- read_csv("https://raw.githubusercontent.com/mpduff/aux_report_2022/main/aux_playset.csv")

network_roster_2021<- read_csv("https://raw.githubusercontent.com/mpduff/aux_report_2022/main/roster_Denver%20Public%20Schools.csv")
```

```{r color_define, include=FALSE}
pal4<-c("deepskyblue1", "darkorchid1", "goldenrod1", "forestgreen")

```

```{r label_role_group_factors, include=FALSE}
network_data_2021$net_role<-factor(network_data_2021$net_role,
levels=c(1,2,3,4),
labels=c("Hub leaders", "Other school and district leaders", "Team leads", "Team members"))
```

```{r label_race_ethnicity_factors, include=FALSE}
network_data_2021<-network_data_2021%>%
  mutate(race_ethnicity=case_when(ethnicity_v3_1==1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Black/ African American",
   ethnicity_v3_1!=1 & ethnicity_v3_2==1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Hispanic/ Latino/ Latina/ Latinx",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3==1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Asian/ Hawaiian/ Pacific Islander",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4==1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "Native American/ First Nation",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5==1 & ethnicity_v3_6!=1 & ethnicity_v3_7!=1 ~ "White",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6==1 & ethnicity_v3_7!=1 ~ "Prefer not to say",
   ethnicity_v3_1!=1 & ethnicity_v3_2!=1 & ethnicity_v3_3!=1 & ethnicity_v3_4!=1 & ethnicity_v3_5!=1 & ethnicity_v3_6!=1 & ethnicity_v3_7==1 ~ "Additional racial/ ethnic identity"))
network_data_2021<-network_data_2021%>%
  mutate("race_ethnicity"=replace_na(race_ethnicity, "Multiple racial/ ethnic identities"))
network_data_2021$race_ethnicity<-factor(network_data_2021$race_ethnicity,
                                         levels=c("Prefer not to say", "Additional racial/ethnic identity", "Multiple racial/ethnic identities", "White", "Native American/ First Nation", "Asian/ Hawaiian/ Pacific Islander", "Hispanic/ Latino/ Latina/ Latinx", "Black/ African American"))

is.factor(network_data_2021$race_ethnicity)

specific_network_data_2021<-network_data_2021%>%
  filter(network_name==params$network_name)
race_data<-specific_network_data_2021%>%
  drop_na(ethnicity_v3)%>%
  mutate(Total=length(ethnicity_v3))

tab_re<-race_data%>%
  group_by(race_ethnicity)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  ungroup()%>%
  complete(race_ethnicity,
           fill=list(Freq=0, Prop=0))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

tab_re
```

```{r label_gender_factors, include=FALSE}
specific_network_data_2021$gender_v3
specific_network_data_2021$gender_v3<-factor(specific_network_data_2021$gender_v3,
levels=c(1,2,3,4,5),
labels=c("Man", "Woman", "Gender queer/Gender non-conforming", "Identity not mentioned", "Prefer not to say"))

gender_data<-specific_network_data_2021%>%
  drop_na(gender_v3)%>%
  mutate(Total=length(gender_v3))

tab_gender<-gender_data%>%
  group_by(gender_v3)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  ungroup()%>%
  complete(gender_v3,
           fill=list(Freq=0, Prop=0))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))
```

```{r prepare_nlgroupcom_stackedbars, include=FALSE}

groupcom_data<-specific_network_data_2021%>%
  pivot_longer(nl_netops_groupcom_1:nl_netops_groupcom_3, names_to="names_gcom", values_to="values_gcom")

groupcom_data$names_gcom<-as.factor(groupcom_data$names_gcom)
groupcom_data$names_gcom<-
  fct_recode(groupcom_data$names_gcom, 
         "Within our local improvement team" = "nl_netops_groupcom_1", 
         "With network leaders" = "nl_netops_groupcom_2",
         "With other participating district or school-based improvement teams" = "nl_netops_groupcom_3"
  )

groupcom_data$values_gcom<-factor(groupcom_data$values_gcom, 
          levels=c(1,2,3,4),
          labels=c("Not enough", "Just right", "Too much", 
                   "Not applicable"))
groupcom_data$values_gcom<-relevel(groupcom_data$values_gcom, "Not applicable")

groupcom_data<-groupcom_data%>%
  drop_na(values_gcom)%>%
  mutate(Total=length(values_gcom)/3)

tab_gcom<-groupcom_data%>%
  group_by(names_gcom, values_gcom)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

tab_gcom_ordered<-tab_gcom%>%
  filter(values_gcom=="Just right")%>%
  arrange(Prop)%>%
  extract2("names_gcom")

```

```{r prepare_time_bars, include=FALSE}
specific_network_data_2021$so_part_t<-factor(specific_network_data_2021$so_part_t,
                                    levels=c(1,2,3,4,5,6,7),
                                    labels=c("0-15 minutes", "16-30 minutes", "31-45 minutes", "46-60 minutes", "61-75 minutes", "76-90 minutes", "more than 90 minutes"))

time_data<-specific_network_data_2021%>%
  drop_na(so_part_t)%>%
  mutate(Total=length(so_part_t))

tab_time<-time_data%>%
  group_by(so_part_t)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))
```

```{r prepare_expect_bars, include=FALSE}
specific_network_data_2021$so_part_expec<-factor(specific_network_data_2021$so_part_expec,
                                    levels=c(1,2,3,4,5),
                                    labels=c("Much less than expected", "Somewhat less than expected", "Same as expected", "Somewhat more than expected", "Much more than expected"))

expect_data<-specific_network_data_2021%>%
  drop_na(so_part_expec)%>%
  mutate(Total=length(so_part_expec))

tab_expect<-expect_data%>%
  group_by(so_part_expec)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))
```

```{r prepare_util_stackedbars, include=FALSE}

useful_data<-specific_network_data_2021%>%
  pivot_longer(so_part_util_012021:so_part_util_152021, names_to="names_util", values_to="values_util")

useful_data$names_util<-as.factor(useful_data$names_util)
useful_data$names_util<-
  fct_recode(useful_data$names_util, 
         "Participating in network-wide meetings" = "so_part_util_012021", 
         "Participating in local improvement team meetings" = "so_part_util_022021",
         "Collaborating with other network members through web-based tools (e.g., Slack, GoogleDrive, Discussion Boards)" = "so_part_util_152021"
  )

useful_data$values_util<-factor(useful_data$values_util, 
          levels=c(1,2,3,4,5,9),
          labels=c("Not at all useful", "A little bit useful", "Moderately useful", 
                   "Useful", "Very useful", 
                   "N/A; haven't done this year"))
useful_data$values_util<-relevel(useful_data$values_util, "N/A; haven't done this year")

useful_data<-useful_data%>%
  drop_na(values_util)%>%
  mutate(Total=length(values_util)/3)

tab_useful<-useful_data%>%
  group_by(names_util, values_util)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

tab_useful_ordered<-tab_useful%>%
  filter(values_util=="Very useful")%>%
  arrange(Prop)%>%
  extract2("names_util")

```

```{r prepare_network_recommend_data, include=FALSE}
recommend_data<-specific_network_data_2021%>%
  drop_na(recommend)%>%
  mutate(Total=length(recommend))%>%
  mutate(Sum=sum(recommend))
  
total_recommend<-length(recommend_data$recommend)
sum_recommend<-sum(recommend_data$recommend)
mean_recommend<-round(sum_recommend/total_recommend, 2)

tab_recommend<-recommend_data%>%
  group_by(net_role, recommend)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

mean_recommend
```

```{r prepare_improvementteam_yn_donut, include=FALSE}
specific_network_data_2021$part_team_meetings_1

specific_network_data_2021$part_team_meetings_1<-factor(specific_network_data_2021$part_team_meetings_1,
                  levels=c(1,2),
                  labels=c("Yes", "No"))
team_meet<-specific_network_data_2021%>%
  drop_na(part_team_meetings_1)%>%
  mutate(Total=length(part_team_meetings_1))

tab_team_meet<-team_meet%>%
  group_by(part_team_meetings_1, net_role)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

tab_team_meet_donut<-team_meet%>%
  group_by(net_role, part_team_meetings_1)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))%>%
  mutate(ymax=cumsum(Prop))%>%
  mutate(ymin=c(0, head(ymax, n=-1)))

tab_team_meet_ol<-team_meet%>%
  filter(net_role=="Other school and district leaders")%>%
  group_by(part_team_meetings_1)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))%>%
  mutate(ymax=cumsum(Prop))%>%
  mutate(ymin=c(0, head(ymax, n=-1)))

tab_team_meet_ol

tab_team_meet
```

```{r meeting_frequency_bar, include=FALSE}
specific_network_data_2021$part_team_meet_32021<-factor(specific_network_data_2021$part_team_meet_32021,
                                                        levels=c(1,2,3,4,5),
                                                        labels=c("Never", "Every 3 months or less", "Every other month", "Once a month", "More than once a month"))

meet_freq_data<-specific_network_data_2021%>%
  drop_na(part_team_meet_32021)%>%
  mutate(Total=length(part_team_meet_32021))

tab_meet_freq<-meet_freq_data%>%
  group_by(part_team_meet_32021)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=percent(Prop, accuracy=1))
```

```{r prepare_meeting_participation_bars, include=FALSE}
specific_network_data_2021$part_team_meetings_2<-factor(specific_network_data_2021$part_team_meetings_2,
                                                    levels=c(1,2,3,4,5),
                                                    labels=c("Never", "Rarely", "Some meetings", "Almost all meetings", "All meetings"))

meet_part_data<-specific_network_data_2021%>%
  drop_na(part_team_meetings_2)%>%
  mutate(Total=length(part_team_meetings_2))

tab_meet_part<-meet_part_data%>%
  group_by(part_team_meetings_2)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=percent(Prop, accuracy=1))
```

```{r prepare_equitydis_stackedbars, include=FALSE}

eqdis_data<-specific_network_data_2021%>%
  pivot_longer(equity_dis_1:equity_dis_3, names_to="names_eqdis", values_to="values_eqdis")

eqdis_data$names_eqdis<-as.factor(eqdis_data$names_eqdis)
eqdis_data$names_eqdis<-
  fct_recode(eqdis_data$names_eqdis, 
         "How race and racism operate in our improvement work" = "equity_dis_1", 
         "How gender and misogyny operate in our improvement work" = "equity_dis_2",
         "How class and classism operate in our improvement work" = "equity_dis_3"
  )

eqdis_data$values_eqdis<-factor(eqdis_data$values_eqdis, 
          levels=c(1,2,3,4,5),
          labels=c("Never", "Every 3 months or less", "Every other month", 
                   "Once a month", "More than once a month"))

eqdis_data<-eqdis_data%>%
  drop_na(values_eqdis)%>%
  mutate(Total=length(values_eqdis)/3)

tab_eqdis<-eqdis_data%>%
  group_by(names_eqdis, values_eqdis)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

tab_eqdis_ordered<-tab_eqdis%>%
  filter(values_eqdis=="More than once a month")%>%
  arrange(Prop)%>%
  extract2("names_eqdis")

```

```{r prepare_inquiry_yn_bars, include=FALSE}
specific_network_data_2021$is_inqcyclechal_y_n<-factor(specific_network_data_2021$is_inqcyclechal_y_n,
levels=c(1,2,3),
labels=c("Yes", "No", "I'm not sure"))

inqyn_data<-specific_network_data_2021%>%
  drop_na(is_inqcyclechal_y_n)%>%
  mutate(Total=length(is_inqcyclechal_y_n))

tab_inqyn<-inqyn_data%>%
  group_by(is_inqcyclechal_y_n)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))

tab_inqyn_role<-inqyn_data%>%
  group_by(net_role, is_inqcyclechal_y_n)%>%
  summarize(Freq=n())%>%
  mutate(Prop=Freq/sum(Freq))%>%
  mutate(Pct=(percent(Prop, accuracy=1)))
```

```{r prepare_leader_sustain_yn, include=FALSE, eval=FALSE}
specific_network_data_2021$sus_begun_planning<-factor(specific_network_data_2021$sus_begun_planning,
levels=c(1,2,3),
labels=c("Yes", "No", "Unsure"))

sus_plan_data<-specific_network_data_2021%>%
  drop_na(sus_begun_planning)%>%
  mutate(Total=length(sus_begun_planning))
```
\
\
\

:::{custom-style="CenterText"}
Part of the Networks for School Improvement Initiative\
Funded by The Bill and Melinda Gates Foundation
\

*Prepared by*:

![](pni_graphic.png){#id .class width=500px height=80px}
\
Learning Research and Development Center\
University of Pittsburgh\
\
\
*In collaboration with*

![](carnegie_graphic.png){#id .class width=350px height=120px}
:::

\newpage
Thank you for your participation in this year’s network health survey. The data in this report overview your network members’ responses to various questions that were included in this year’s survey but are not available through the primary report dashboard. We encourage you to review these data alongside your primary report dashboard to get a more complete understanding of your network’s current health and areas for further development.

# Who took the survey?

```{r response_rate, include=FALSE}
specific_network_data_2021<-network_data_2021%>%
  filter(network_name==params$network_name)
r21<-length(specific_network_data_2021$survey_response_id)
r21
members21<-length(network_roster_2021$first_name)
members21
rr21<-round((r21/members21)*100)
rr21
rr20<-65
```

Overall, your network’s response rate was **`r rr21`%**. This is `r if(rr21>rr20){"an improvement over"}` `r if(rr21==rr20){"consistent with"}` `r if(rr21<rr20){"below"}` last year’s response rate, which was `r rr20`%. `r if(rr21<50){"Given your network response rate was under 50%, we urge you to interpret these results with caution as they represent only a portion of your network’s membership. Please reach out to Partners for Network Improvement (PNI) for tips on how to increase response rates moving forward."}`

Table 1 describes the **distribution of respondents by role group**:

```{r role_group_response_rates, echo=FALSE, tab.cap="Responses by Role Group"}
specific_network_data_2021<-network_data_2021%>%
  filter(network_name==params$network_name)
rolegroup_table<-datasummary(net_role +1 ~ N, data=specific_network_data_2021, output="flextable")
rolegroup_table%>%
  set_header_labels(net_role="Network role", N="Number of respondents")%>%
  width(width=3.25)
```
Note that both the percentages for your overall network response rate and the response rates per role group in Table 1 were calculated using your network roster data from the RAND foundation. 

Table 2 describes the **distribution of respondents by school**:\
[INSERT TABLE WITH RESPONDENTS BY SCHOOL HERE--POSSIBLE TO INCLUDE RESPONSE RATE % HERE?]

Figures \@ref(fig:rrRace) and \@ref(fig:rrGender) show **how your respondents varied by race/ethnicity and gender**, respectively. Given your knowledge of your network’s overall membership, consider whether any particular groups seem under-represented in your respondents this year. How might you increase responses from this group in future surveys to ensure all perspectives are fully reflected in your network’s data?

```{r response_rate_by_race_ethnicity, echo=FALSE, fig.id="rrRace", fig.cap= paste("Survey Respondents by Racial Ethnic Background (n=", race_data$Total, "respondents)")}
race_ethnicity<-ggplot(tab_re, aes(x=fct_reorder(race_ethnicity, Prop, .desc=TRUE), y=Prop)) +
  geom_col(fill="deepskyblue1") +
  coord_flip()+
  geom_text(aes(label=if_else(Prop==0, "0%", Pct), hjust=if_else(Prop>0.05, 1.25, 0)), fontface="bold")+
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L), breaks=extended_breaks(8))+
  scale_x_discrete(drop=FALSE, labels=scales::wrap_format(25))+
  labs (
    title="What is your race/ethnicity?",
    y="Percent of respondents",
    x="Race/ethnicity"
    )+
  theme_classic()+
  theme(plot.title.position="plot")
race_ethnicity + 
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
```      
**Note**: Racial/ethnic categories are ordered from lowest to highest respondent group. 

```{r response_rate_by_gender, echo=FALSE, fig.id="rrGender", fig.cap=paste("Survey Respondents by Gender (n=", gender_data$Total, "respondents)")}
gender<-ggplot(tab_gender, aes(x=fct_reorder(gender_v3, Prop, .desc=TRUE), y=Prop)) +
  geom_col(fill="deepskyblue1") +
  coord_flip()+
  scale_y_continuous(breaks=extended_breaks(6), labels = scales::percent_format(accuracy = 1L))+
  scale_x_discrete(drop=FALSE, labels=scales::wrap_format(25))+
  labs (
    title="What is your gender?",
    x="Gender",
    y="Percent of respondents"
    )+
  theme_classic()+
  theme(plot.title.position="plot")
gender + 
  geom_text(aes(label=if_else(Prop==0, "0%", Pct), hjust=if_else(Prop>0.05, 1.25, 0)), fontface="bold")+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
``` 
**Note**: Gender categories are ordered from lowest to highest respondent group. 

You'll notice on these figures and throughout the report, we list the sample size (n) for each question. These sample sizes vary between questions for two reasons: (1) Some questions were only asked of particular role groups (e.g., network members and team leads); (2) Some individuals skipped questions while taking the survey.
We've specified when questions only pertain to certain role groups throughout the report to aid your interpretation of the data. 

\newpage
# How do network members view network leadership?

Network leadership develops and sustains many other aspects of network health. Thus, it is important to understand how network members view your network’s leadership. As a reminder, these data are particularly helpful when considered alongside other measures of network leadership included in the primary network health report.

Figure # displays the **percentage of network members who know who their network leaders are**. Figure # displays the distribution of members who believe **the roles and responsibilities of network leaders are clear to them**.

[INSERT NL_BACKGROUND_1 BAR GRAPH HERE (FIGURE #)]

[INSERT NL_BACKGROUND_2 BAR GRAPH HERE (FIGURE #)]

`r if(params$engagement){"Figure # displays **how network members report typically engaging with network leaders**. Note, these data are only for those members who indicated they know who their leaders are (see Figure #)."}`

[INSERT NL_BACKGROUND_3_n HERE (FIGURE #)]

Finally, Figure # displays **how network members feel about communication with various sources in the network**. Note, these data are for all network members, regardless of whether they know who their leaders are.

``` {r group_communication, echo=FALSE, fig.height=4, fig.id="gcom", fig.cap=paste("Amount of Communication with Network Sources (n=", groupcom_data$Total, "respondents)")}

gcom_plot<-tab_gcom%>%
  mutate(names_gcom=factor(names_gcom, tab_gcom_ordered))%>%
           ggplot(aes(x=names_gcom, y=Prop, fill=fct_rev(values_gcom)))+
  geom_col(position=position_stack())+
  coord_flip()+
  geom_text(aes(label=ifelse(Prop > 0.05, Pct, "")), size=3, color="black", fontface="bold", 
            position = position_stack(vjust=.5))+
  scale_x_discrete(labels = scales::wrap_format(25))+
  scale_y_continuous(breaks=extended_breaks(6), labels = scales::percent_format(accuracy = 1L))+
  labs (
    title="What best describes your feelings about the amount of communication with the following sources?",
    y="Percent of respondents",
    x="Types of communication")+
  scale_fill_brewer(palette="PuBu", direction=-1, breaks=c("Not applicable", "Not enough", "Just right", "Too much"))+
  theme_classic()+
  theme(plot.title.position="plot",
        legend.position= "bottom",
        legend.box="horizontal",
        legend.background=element_rect(fill="gray100", color="black"),
        legend.title=element_blank())
gcom_plot+guides(fill=guide_legend(nrow=1))+
  theme(
    plot.title = element_text(family="sans", size=10, face="bold.italic"),
    axis.title.y = element_text(family="sans", size=10, color="black"),
    axis.title.x = element_text(family="sans", size=10, color="black"),
    axis.text.y=element_text(family="sans", size=8, color="black"),
    axis.text.x=element_text(family="sans", size=8, color="black"),
    legend.text=element_text(size=8)  
    )
```
Together, these data show how well your members know and understand the function of leaders in your network. If your results are lower than you would expect on these measures, consider whether you can do anything to bolster connections with and support from network leaders.

\newpage
# How do respondents perceive their engagement with the network?

These data summarize network members’ perceptions of time spent on network activities. Network members have multiple responsibilities, and it is crucial they view their participation as valuable if they are going to prioritize network activities amongst competing professional demands.

```{asis time_text, echo=params$time}
Figure \@ref(fig:time) displays **how much time network members estimate they spend participating in the network weekly**.
```

``` {r participation_time, eval=params$time, echo=FALSE, fig.id="time", fig.cap=paste ("Estimated Weekly Network Participation (n=", time_data$Total, "respondents)")}
time_plot<-ggplot(tab_time, aes(x= fct_rev(factor(so_part_t)), y= Prop))+
  geom_col(fill="deepskyblue1")+
  scale_x_discrete(drop=FALSE)+
  scale_y_continuous(breaks=extended_breaks(6), labels = scales::percent_format(accuracy = 1L))+
  coord_flip()+
  labs (
    title="How much time do you spend on network activities weekly?",
    y="Percent of respondents",
    x="Time on network activities")+
  theme_classic()+
  theme(plot.title.position="plot")
time_plot+
  geom_text(aes(label=if_else(Prop==0, "0%", Pct), hjust=if_else(Prop>0.05, 1.25, 0)), fontface="bold")+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
```

```{asis expect_text, echo=params$expect}
Figure \@ref(fig:expect) displays **how much time network members estimate they spend participating in the network weekly**.
```

```{r participation_expect, eval=params$expectations, echo=FALSE, fig.id="expect", fig.cap=paste("Expected Participation in Network Activities (n=", expect_data$Total, "respondents)")}
plot_expect<-ggplot(tab_expect, aes(x=fct_rev(factor(so_part_expec)), y=Prop))+
  geom_col(fill="deepskyblue1")+
  coord_flip()+
  scale_y_continuous(breaks=extended_breaks(6), labels = scales::percent_format(accuracy = 1L))+
  scale_x_discrete(drop=FALSE, labels=scales::wrap_format(15))+
  labs(
    title="Which statement best describes the amount of time that you are currently spending\non work relate to the network?",
    y="Percent of respondents",
    x="Expectations"
  )+
  theme_classic()+
  theme(plot.title.position="plot")
plot_expect+
  geom_text(aes(label=if_else(Prop==0, "0%", Pct), hjust=if_else(Prop>0.05, 1.25, 0)), fontface="bold")+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)

```

`r if(params$time & params$expect) {"Together, these questions give you an idea of whether members are spending a reasonable amount of time on network-related activities, and whether the hub or other network stakeholders might consider ways to manage participants’ expectations around network participation."}`

Figure \@ref(fig:useful) displays **the usefulness of various network activities from the perspective of network members**. Consider which activities network members find most useful: Are these the activities on which they spend the most time? Are there steps you could take to improve the utility of other network activities that members currently view as less useful?

``` {r useful_activities, echo=FALSE, fig.height=4, fig.id="useful", fig.cap=paste("Usefulness of Various Network Activities (n=", useful_data$Total, "respondents)")}

useful_plot<-tab_useful%>%
  mutate(names_util=factor(names_util, tab_useful_ordered))%>%
           ggplot(aes(x=names_util, y=Prop, fill=fct_rev(values_util)))+
  geom_col(position=position_stack())+
  coord_flip()+
  geom_text(aes(label=ifelse(Prop > 0.05, Pct, "")), size=3, color="black", fontface="bold", 
            position = position_stack(vjust=.5))+
  scale_x_discrete(labels = scales::wrap_format(25))+
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L))+
  labs (
    title="Please indicate how useful each activity is to you.",
    y="Percent of respondents",
    x="Network activities")+
  scale_fill_brewer(palette="PuBu", direction=-1, breaks=c("N/A; haven't done this year", "Not at all useful", "A little bit useful", "Moderately useful", "Useful", "Very useful"))+
  theme_classic()+
  theme(plot.title.position="plot",
        legend.position= "bottom",
        legend.box="horizontal",
        legend.spacing.x=(unit(0.1, 'cm')),
        legend.background=element_rect(fill="gray100", color="black"),
        legend.title=element_blank())
useful_plot+guides(fill=guide_legend(nrow=1))+
  theme(
    plot.title = element_text(family="sans", size=10, face="bold.italic"),
    axis.title.y = element_text(family="sans", size=10, color="black"),
    axis.title.x = element_text(family="sans", size=10, color="black"),
    axis.text.y=element_text(family="sans", size=8, color="black"),
    axis.text.x=element_text(family="sans", size=8, color="black"),
    legend.text=element_text(size=6),
    legend.key.size=unit(0.25, 'cm')
  )
```
**Note**: Activities are ordered from most to least useful. 

Overall, network members’ satisfaction with network engagement is captured by their assessment of whether they would recommend this network to a colleague. Figure \@ref(fig:netRec) displays the **distribution of network members (except hub members) who would recommend this network to a colleague**. Note that this figure divides responses by respondents' roles within the network, allowing you to compare across role groups. 

```{r recommend_graph, echo=FALSE, fig.id="netRec", fig.cap=paste("Network Recommendation (n=", recommend_data$Total, "respondents)")}

rec_graph<-ggplot(tab_recommend, aes(x=recommend, y=Freq, fill=net_role))+
  geom_col(position="stack")+
  scale_x_continuous(breaks=extended_breaks(10))+
  labs (
    title="Would you recommend this network to a colleague?",
    y="Number of respondents",
    x="Network recommendation (1=Certainly not, 10=Certainly)")+
  scale_fill_manual(values=pal4)+
  theme_classic()+  
  theme(plot.title.position="plot",
        legend.position="bottom",
        legend.background=element_rect(fill="gray100", color="black"),
        legend.title=element_blank(),
        panel.grid.major.y = element_line(color="grey", size=0.25))

rec_graph + theme(
    plot.title = element_text(family="sans", size=10, face="bold.italic"),
    axis.title.y = element_text(family="sans", size=10, color="black"),
    axis.title.x = element_text(family="sans", size=10, color="black"),
    axis.text.y=element_text(family="sans", size=8, color="black"),
    axis.text.x=element_text(family="sans", size=8, color="black")
  )

```

On average, network members' likelihood to recommend the network to a colleague was **`r mean_recommend`**. This is an [increase over/is consistent with/is below] network members' likelihood to recommend the network last year, which was 8.0. 

\newpage
# How do network members perceive participation in local improvement team meetings?

Consistency of network participation is important to building internal team connections and helping improvement to flourish. Team meetings need to occur frequently enough to maintain momentum around network goals and allow for collaborative problem solving and discussion. However, if network meetings occur too frequently, members may not be able to consistently attend. 

Figure \@ref(fig:teamDonut) displays **the number of members (excluding the network hub) who indicated they are part of a local improvement team**.  

```{r team_meetings_donut, echo=FALSE, fig.id="teamDonut", fig.height=2, fig.cap=paste ("Number of Members who Report Participating in Local Improvement Team Meetings (n=", team_meet$Total, "respondents)")}

#Note we don't use this first one, but keeping the code here just in case!
meetings_donut <- ggplot(tab_team_meet_donut) +
    geom_rect(aes(xmin=2, xmax=4, ymin=ymin, ymax=ymax, fill=part_team_meetings_1)) +
    coord_polar(theta="y", start=0, direction=1) +
    xlim(c(0, 5)) +
   scale_fill_manual(values=c("deepskyblue1", NA, NA)) +
    geom_text(aes(x=0, y=0, label=paste0(round(Prop[1], 2)*100, '%')), size=6) +
    geom_text(aes(x=5, y=.5, label=""), size=6) +
    theme_void() +
    theme(legend.position="none")

meetings_stack<-ggplot(tab_team_meet, aes(x=part_team_meetings_1, y=Freq, fill=net_role))+
  geom_col(position="stack")+
  coord_flip()+
  labs (
    title="Participation",
    y="Number of respondents",
    x="Participation")+
  scale_fill_manual(values=pal4)+
  theme_classic()+  
  theme(plot.title.position="plot",
        legend.position="bottom",
        legend.background=element_rect(fill="gray100", color="black"),
        legend.title=element_blank())

meetings_stack + theme(
    plot.title = element_text(family="sans", size=10, face="bold.italic"),
    axis.title.y = element_text(family="sans", size=10, color="black"),
    axis.title.x = element_text(family="sans", size=10, color="black"),
    axis.text.y=element_text(family="sans", size=8, color="black"),
    axis.text.x=element_text(family="sans", size=8, color="black"),
  )
```
The following questions pertain to those members who indicated they were part of a local improvement team. Figure \@ref(fig:meetFreq) displays **how frequently local improvement team meetings occur** while Figure \@ref(fig:meetPart) displays **how often members report participating in local improvement team meetings**.

``` {r team_meet_freq, echo=FALSE, fig.id="meetFreq", fig.cap=paste ("Frequency of Local Improvement Team Meetings (n=", meet_freq_data$Total, "respondents)")}
meet_freq_plot<-ggplot(tab_meet_freq, aes(x= fct_rev(factor(part_team_meet_32021)), y= Prop))+
  geom_col(fill="deepskyblue1")+
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L), breaks=extended_breaks(8))+
  scale_x_discrete(labels = scales::wrap_format(15), drop=FALSE)+
  coord_flip()+
  labs (
    title="My local improvement team meets:",
    y="Percent of respondents",
    x="Meeting frequency")+
  theme_classic()+
  theme(plot.title.position="plot")
meet_freq_plot+
  geom_text(aes(label=if_else(Prop==0, "0%", Pct), hjust=if_else(Prop>0.05, 1.25, 0)), fontface="bold")+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
```

``` {r team_meet_part, echo=FALSE, fig.id="meetPart", fig.cap=paste ("Participation in Local Improvement Team Meetings (n=", meet_part_data$Total, "respondents)")}
meet_freq_plot<-ggplot(tab_meet_part, aes(x= fct_rev(factor(part_team_meetings_2)), y= Prop))+
  geom_col(fill="deepskyblue1")+
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L), breaks=extended_breaks(8))+
  scale_x_discrete(labels = scales::wrap_format(15))+
  coord_flip()+
  labs (
    title="I participate in my local improvement team meetings:",
    y="Percent of respondents",
    x="Meeting frequency")+
  theme_classic()+
  theme(plot.title.position="plot")
meet_freq_plot+
  geom_text(aes(label=ifelse(Prop > 0.05, Pct, "")), hjust=1.5, fontface="bold")+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
```

`r if(params$equity){"Additionally, it is important to not only consider frequency and attendance within improvement team meetings, but also the content of those meetings, or what members typically do or discuss when in attendance. Figure # displays members’ perceptions of the **frequency with which they discuss various topics related to equity during local improvement team meetings**. Given the centrality of diversity, equity, and inclusion to network improvement, consider whether local improvement teams need additional support around how to center equity in team meetings moving forward."}`

[INSERT EQUITY_DIS_n HERE (FIGURE #)]

`r if(params$trust){"Finally, Figure # displays **network members’ perceptions of relational trust within local improvement teams**. Consider whether this is sufficient to engage in productive dialogue and improvement routines."}`

[INSERT SO_RT_n HERE (FIGURE #)]

Inquiry routines are a key aspect of the continuous improvement process; however, they can be difficult to implement and master. These data summarize the degree to which your network members find various aspects of inquiry routines challenging.

Figure \@ref(fig:inqcycleyn) displays **the number of team members and team leads who indicated they engaged in inquiry cycle routines this year**.

``` {r inqcycle_y_n, echo=FALSE, fig.id="inqcycleyn", fig.cap=paste ("Engagement in Inquiry Cycles (n=", inqyn_data$Total, "respondents)")}
inq_plot<-ggplot(tab_inqyn, aes(x= fct_reorder(is_inqcyclechal_y_n, Pct, .desc=TRUE), y= Prop))+
  geom_col(fill="deepskyblue1")+
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L), breaks=extended_breaks(8))+
  coord_flip()+
  labs (
    title="Have you engaged in any inquiry routines this school year?",
    y="Percent of respondents",
    x="Engagement")+
  theme_classic()+
  theme(plot.title.position="plot")
inq_plot+
  geom_text(aes(label=ifelse(Prop > 0.05, Pct, "")), hjust=1.5, fontface="bold")+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)
```

Figure \@ref(fig:inqcycNr) shows this same data disaggregated by network role.
```{r inqcycle_by_role, echo=FALSE, fig.id="inqcycNr", fig.cap=paste ("Engagement in Inquiry Cycles by Network Role (n=", inqyn_data$Total, "respondents)")}
inq_stack<-ggplot(tab_inqyn_role, aes(x=fct_reorder(is_inqcyclechal_y_n, Freq, .desc=TRUE), y=Freq, fill=net_role))+
  geom_col(position="stack")+
  coord_flip()+
  labs (
    title="Have you engaged in any inquiry routines this school year?",
    y="Number of respondents",
    x="Engagement")+
  scale_fill_manual(values=pal4)+
  theme_classic()+  
  theme(plot.title.position="plot",
        legend.position="bottom",
        legend.background=element_rect(fill="gray100", color="black"),
        legend.title=element_blank())

inq_stack+
  theme(
  plot.title = element_text(family="sans", size=10, face="bold.italic"),
  axis.title.y = element_text(family="sans", size=10, color="black"),
  axis.title.x = element_text(family="sans", size=10, color="black"),
  axis.text.y=element_text(family="sans", size=8, color="black"),
  axis.text.x=element_text(family="sans", size=8, color="black")
)

```
The remaining data in this section provide further insights from those members who shared that they do participate in inquiry routines. Team members and team leads were asked to **indicate the extent to which they found various aspects of inquiry routines challenging** (Figure #). Within your network, we found the following responses:

[INSERT IS_INQCYCLECHAL_12021, IS_INQCYCLECHAL_52021, IS_INQCYCLECHAL_32021, IS_INQCYCLECHAL_42021, IS_INQCYCLECHAL_82021 HERE (FIGURE #)]

While we anticipate a learning curve in mastering inquiry routines, if these responses are lower than you would expect, consider any additional steps the network hub can take to support members around challenging aspects of the work. Note also those aspects of inquiry routines members said were not applicable to their practice. Are these practices you would expect members to be familiar with?

```{asis state_text, echo=params$state}
\newpage
# How do network members perceive the network's alignment with state piorities?

```

`r if(params$state){"An important, yet often difficult, aspect of network health is aligning the networks’ goals and activities with other priorities in schools’ surrounding environments. This increases the sense of coherence within network schools and may contribute to network engagement and sustainability."}`

`r if(params$state){"While the primary report provides information about how network members perceive the network’s alignment with school and local district priorities, here we present data on the alignment of network goals with state-level priorities. Figure # displays the **distribution of network members (except hub members) who agree that the work they are doing in the network is consistent with the state’s programs and policies aimed at improving the network outcome**."}`

\newpage
# How do network members view the sustainability of the network?

This year, we began collecting data around a new set of questions aimed to help us understand perspectives around and strategies for network sustainability across the BMGF initiative. While a larger report on sustainability across the initiative is forthcoming, these data show how your network members are thinking about sustainability of various network activities. These data are divided by role group to allow you to compare the responses of those in network leadership to those in other positions within the network.

## Network leaders' perceptions of sustainability

Figure # displays the **percentage of network leaders who indicated the network was already planning for sustainability**. The remaining data in this section draw from this sample of network leaders.

Figure # summarizes the **extent to which network leaders’ believe various network elements are currently prioritized in the network’s sustainability planning**. 

Finally, Figure # provides an overview of **how network leaders perceive potential challenges to network sustainability after support from BMGF ends**.

## Other network members' perceptions of network sustainability

Network members were first asked to **indicate the extent to which they agreed that various network activities were having an influence within their broader school context** (Figure #). We consider this an important precursor to sustainability as it indicates the extent to which network approaches have potentially spread within schools, giving the network firmer roots in the local context. 

Figures #-## display network members’ perceptions of the likelihood that various network activities will sustain after the network no longer has access to support from BMGF. Figure # displays **how members view sustainability of network activities within their school**. Figure # displays **how they view sustainability of activities within their local improvement team**. Finally, Figure # displays **how members themselves foresee sustaining various improvement activities**. Consider how these responses align with (or diverge from) network leaders’ priorities for network sustainability.

Finally, Figure # provides an overview of **how network members perceive various potential challenges to network sustainability**.

Consider how these perspectives align with leaders’ sustainability priorities and their own views of potential threats to sustainability. 
